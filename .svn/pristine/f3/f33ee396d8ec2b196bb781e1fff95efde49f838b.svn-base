<!DOCTYPE HTML>
<html>
<head>
    <title>博客主页</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.poptrox.min.js"></script>
    <script src="js/skel.min.js"></script>
    <script src="js/init.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="bootstrap/css/bootstrap-theme.min.css" />
    <noscript>
        <link rel="stylesheet" href="css/skel.css" />
        <link rel="stylesheet" href="css/style.css" />
        <link rel="stylesheet" href="css/style-xlarge.css" />
    </noscript>
    <!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
</head>
<body id="top">

<!-- Header -->
<header id="header">
    <a href="#" class="image avatar"><img src="images/bg.jpg" alt="" /></a>
    <h1><strong>I am Strata</strong>, a super simple<br />
        responsive site template freebie<br />
        crafted by.</h1>
</header>

<!-- Main -->
<div id="main">
    <div id="article-area">

    </div>
    <button  id="more-articles" type="button" class="btn btn-default">查看更多</button>

</div>

<!-- Footer -->
<footer id="footer">
    <ul class="icons">
        <li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
        <li><a href="#" class="icon fa-github"><span class="label">Github</span></a></li>
        <li><a href="#" class="icon fa-dribbble"><span class="label">Dribbble</span></a></li>
        <li><a href="#" class="icon fa-envelope-o"><span class="label">Email</span></a></li>
    </ul>
    <ul class="copyright">
        <li>&copy; sg<li>hhhh</li></li>
    </ul>
</footer>
</body>
</html>
<script>
    IndexData= {
        pageIndex : 1,
        pageSize : 5,
        sortName : 'createDate',
        sortType : 'desc',
        maxArticleSum : 0,
        currentArticleSum:0,
        selectedArticle:null
    }
    IndexUtil={
        init:function(){

            $('#more-articles').on('click',function(){
                IndexUtil.getArticleList();
            });
            IndexUtil.getArticleList();
            $('#article-area').on('click','.button',function(){
                IndexData.selectedArticle = $(this).parent().parent().parent();
                IndexUtil.articleContent();
            });
        },
        articleContent:function(){

            $.ajax({
                type: 'GET',
                url: 'article',
                data: {'id':IndexData.selectedArticle.attr('id')},
                success: function (page) {
                    $('#main').html(page);
                },
                error: function () {
                    $('#main').html('<div>网络错误</div>')
                }
            });
        },
        getArticleList:function(){
            $.ajax({
                type:'GET',
                url:'admin/articleList',
                data:{'limit':IndexData.pageSize,
                    'page':IndexData.pageIndex,
                    'sortName':IndexData.sortName,
                    'sortType':IndexData.sortType
                },
                success:function (json) {
                    IndexData.maxArticleSum = json.totalCount;
                    $.each(json.items,function(index,item){
                        IndexUtil.showArticle(index,item);
                    });

                    IndexData.currentArticleSum += $(json.items).length;
                    IndexData.pageIndex++;
                    if(IndexData.currentArticleSum >= IndexData.maxArticleSum){
                        $('#more-articles').remove();
                    }
                },
                error:function(){
                  alert('加载失败');
                }
            });
        },
        showArticle:function(index,item){
            var appenHtml ='<section id="' + item.id + '" style='+'"border-style:sol'+'">';
            appenHtml+= '<span>'+item.createDate + '</span>';
            appenHtml+='<header class="'+'major">';
            appenHtml+='<h2>'+item.title+'</h2>';
            appenHtml+='</header>';
            appenHtml+='<p>'+item.content+'</p>';
            appenHtml+='<ul class="'+'actions">';
            appenHtml+='<li><a href="'+'#" class='+'"button'+'">Learn More</a></li>';
            appenHtml+='</ul>';
            appenHtml+='</section>';
            $('#article-area').append(appenHtml);
            //$('#article-area').html($('#article-area').html() + appenHtml);
        }
    }
    $(function(){
        IndexUtil.init();
    })
</script>